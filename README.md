# MADE-facial-keypoints-detection

Ноутбук с Kaggle InClass соревнования "Thousand Facial Landmarks", проходившего рамках курса MADE Computer Vision.

## Описание задачи

В рамках соревнования надо было определить 971 ключевую точку лица человека по фотографии. В качестве соревновательной метрики была выбрана MSE.  

![Alt text](images/sample2.jpg.png?raw=true "Sample")

## Ключевые моменты решения и испробованные подходы

### Модели

Модели которые были опробованы в процессе решения задачи: resnet34, resnet50, resnext50_32x4d.
Они все показали примерно одинаковое качество, но лучшее качество с небольшим перевесом показала модель resnet50. Все модели использовались с предобученными на ImageNet весами.

### Детали обучения
Каждая модель училась по 25-35 эпох, используя Adam в качестве оптимизатора и ReduceLROnPlateau в качестве scheduler`a. Начальный Learning Rate был 1е-3, с последующим его понижением в 0.25 раз если модель не улучшала свое качество на валидации в течении 4 последних эпох. Также был опробован метод обучения с последней удачной эпохи(небольшая разница между train loss и valid loss + низкая MSE), используя меньший Learning Rate, что в основном давало хороший результат.
Размер батча старался выбирать не слишком быольшой в основном 256/128, полагаясь на нормализацию в batch norm, так как она в основном приводит к более сильной регуляризации.

Тренировка моделей без использования предобученных весов ожидаемо не дала положительного эффекта.

### Аугментации

В конечном счете пришлось от них оказаться, но были испробованы следующие:
- из библиотеки albumentations: Blur, MotionBlur, RandomBrightnessContrast. Все очень сильно ухудшали скорость обучения модели. Отчасти это из-за того, что часть изображений и так была недостаточного качества, и аугментированные изображения становились совсем не похожими на оригинальные изображения.
- из библиотеки torchvision.transforms были опробованы ColorJitter, Grayscale и RandomErasing. Первая замедляла качество, тогда как вторая ничего не добавляла в качестве, поэтому от нее решил отказаться. Случайное затемнее также не дало прироста в производительности модели, что показалось странным, возможно неправильно настроил.

## Результат

![Alt text](images/Submit_screenshot.png?raw=true "Submit")
